tinymce.PluginManager.add("octo_textcolor",function(o){function t(t){var e;return o.dom.getParents(o.selection.getStart(),function(o){var r;!e&&(r=o.style["forecolor"==t?"color":"background-color"])&&(e=r)}),e}function e(t,e){o._octColorPickerBookmark&&o.selection.moveToBookmark(o._octColorPickerBookmark),o.formatter.apply(t,{value:e})}function r(o,t){e(o,t)}function n(o){if(o){if(o._items&&o._items.length)for(var t=0;t<o._items.length;t++){if(o._items[t]._classes&&o._items[t]._classes[0]&&"colorbutton"==o._items[t]._classes[0])return o._items[t];var e=n(o._items[t]);if(e)return e}return!1}}function c(o,e){e=e?e:t("forecolor"),o.css({"background-color":e})}var l,i;i=o.settings.textcolor_rows||5,l=o.settings.textcolor_cols||8,o.on("click",function(){if(o.theme){var t=n(o.theme.panel);if(!t)return;var e=null;for(var r in t._elmCache){e=t._elmCache[r];break}c(jQuery(e).find(".octColorpickerInput"))}}),o.on("BeforeRenderUI",function(o){var t=n(o.target.theme.panel);t&&setTimeout(function(){var o=null;for(var e in t._elmCache){o=t._elmCache[e];break}jQuery(o).html('<div class="octColorpickerInputShell"><div class="octColorpickerInput"></div></div>'),c(jQuery(o).find(".octColorpickerInput"))},10)}),o.addButton("forecolor",{type:"panelbutton",tooltip:"Text color",format:"forecolor",classes:"colorbutton",panel:{role:"application",ariaRemember:!0,html:"",classes:"colorpanel",border:1,onpostrender:function(o){o.control._octInited||(o.control._octFirstTimeChange=!0,jQuery("#"+o.control._id).ColorPickerSliders({placement:"bottom",appendto:"#"+o.control._id,color:"rgba(255, 255, 255, 1)",order:{hsl:1,opacity:2},customswatches:"different-swatches-groupname",swatches:["rgba(255, 0, 0, 1)","rgba(0, 255, 0, 1)","blue"],labels:{hslhue:"color tone",hslsaturation:"saturation",hsllightness:"brightness",opacity:"alfa"},onchange:function(t,e){if(!o.control._octFirstTimeChange){var n=e.tiny.toRgbString();r("forecolor",n),c(this.connectedinput.find(".octColorpickerInput"),n)}o.control._octFirstTimeChange=!1},flat:!0}),o.control._octInited=!0)},onshow:function(e){o._octColorPickerBookmark=o.selection.getBookmark(2,!0);var r=t("forecolor");jQuery("#"+e.control._parent._id).trigger("colorpickersliders.updateColor",r)}}})});